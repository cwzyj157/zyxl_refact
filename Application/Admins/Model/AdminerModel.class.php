<?php
namespace Admins\Model;
use Think\Model;

/*
ThinkPHP è‡ªåŠ¨éªŒè¯
array(éªŒè¯å­—æ®µ1,éªŒè¯è§„åˆ™,é”™è¯¯æç¤º,[éªŒè¯æ¡ä»¶,é™„åŠ è§„åˆ™,éªŒè¯
æ—¶é—´]),
éªŒè¯å­—æ®µ: ä¸ä¸€å®šæ˜¯æ•°æ®åº“å­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯è¡¨å•çš„ä¸€äº›è¾…åŠ©å­—æ®?
éªŒè¯è§„åˆ™ï¼? TPé»˜è®¤ : require å­—æ®µå¿…é¡»ã€email é‚®ç®±ã€url URLåœ°å€ã€currency è´§å¸ã€number æ•°å­—
é”™è¯¯æç¤º:

éªŒè¯æ¡ä»¶:ï¼ˆå¯é€‰ï¼‰
self::EXISTS_VALIDATE æˆ–è??0 å­˜åœ¨å­—æ®µå°±éªŒè¯ï¼ˆé»˜è®¤ï¼?
self::MUST_VALIDATE   æˆ–è??1 å¿…é¡»éªŒè¯
self::VALUE_VALIDATE  æˆ–è??2 å€¼ä¸ä¸ºç©ºçš„æ—¶å€™éªŒè¯?

é™„åŠ è§„åˆ™ ï¼ˆå¯é€‰ï¼‰
regex       æ­£åˆ™éªŒè¯ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼ˆé»˜è®¤ï¼‰
function    å‡½æ•°éªŒè¯ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™æ˜¯ä¸€ä¸ªå‡½æ•°å
callback    æ–¹æ³•éªŒè¯ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™æ˜¯å½“å‰æ¨¡å‹ç±»çš„ä¸€ä¸ªæ–¹æ³?
confirm		éªŒè¯è¡¨å•ä¸­çš„ä¸¤ä¸ªå­—æ®µæ˜¯å¦ç›¸åŒï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™æ˜¯ä¸€ä¸ªå­—æ®µå
equal       éªŒè¯æ˜¯å¦ç­‰äºæŸä¸ªå€¼ï¼Œè¯¥å?¼ç”±å‰é¢çš„éªŒè¯è§„åˆ™å®šä¹?
notequal    éªŒè¯æ˜¯å¦ä¸ç­‰äºæŸä¸ªå?¼ï¼Œè¯¥å?¼ç”±å‰é¢çš„éªŒè¯è§„åˆ™å®šä¹‰ï¼ˆ3.1.2ç‰ˆæœ¬æ–°å¢ï¼?
in          éªŒè¯æ˜¯å¦åœ¨æŸä¸ªèŒƒå›´å†…ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™å¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…é?—å·åˆ†å‰²çš„å­—ç¬¦ä¸²
notin       éªŒè¯æ˜¯å¦ä¸åœ¨æŸä¸ªèŒƒå›´å†…ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™å¯ä»¥æ˜¯ä¸?ä¸ªæ•°ç»„æˆ–è€…é?—å·åˆ†å‰²çš„å­—ç¬¦ä¸²ï¼?3.1.2ç‰ˆæœ¬æ–°å¢ï¼?
length      éªŒè¯é•¿åº¦ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™å¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—ï¼ˆè¡¨ç¤ºå›ºå®šé•¿åº¦ï¼‰æˆ–è€…æ•°å­—èŒƒå›´ï¼ˆä¾‹å¦‚3,12 è¡¨ç¤ºé•¿åº¦ä»?3åˆ?12çš„èŒƒå›´ï¼‰
between     éªŒè¯èŒƒå›´ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™è¡¨ç¤ºèŒƒå›´ï¼Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æˆ–è?…æ•°ç»„ï¼Œä¾‹å¦‚1,31æˆ–è?…array(1,31)
notbetween  éªŒè¯ä¸åœ¨æŸä¸ªèŒƒå›´ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™è¡¨ç¤ºèŒƒå›´ï¼Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æˆ–è?…æ•°ç»?
expire      éªŒè¯æ˜¯å¦åœ¨æœ‰æ•ˆæœŸï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™è¡¨ç¤ºæ—¶é—´èŒƒå›´ï¼Œå¯ä»¥åˆ°æ—¶é—´ï¼Œä¾‹å¦‚å¯ä»¥ä½¿ç”? 2012-1-15,2013-1-15 è¡¨ç¤ºå½“å‰æäº¤æœ‰æ•ˆæœŸåœ¨2012-1-15åˆ?2013-1-15ä¹‹é—´ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ—¶é—´æˆ³å®šä¹?
ip_allow    éªŒè¯IPæ˜¯å¦å…è®¸ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™è¡¨ç¤ºå…è®¸çš„IPåœ°å€åˆ—è¡¨
ip_deny     éªŒè¯IPæ˜¯å¦ç¦æ­¢ï¼Œå®šä¹‰çš„éªŒè¯è§„åˆ™è¡¨ç¤ºç¦æ­¢çš„ipåœ°å€åˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”
unique      éªŒè¯æ˜¯å¦å”¯ä¸€ï¼Œç³»ç»Ÿä¼šæ ¹æ®å­—æ®µç›®å‰çš„å?¼æŸ¥è¯¢æ•°æ®åº“æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç›¸åŒçš„å€¼ï¼Œå½“è¡¨å•æ•°æ®ä¸­åŒ…å«ä¸»é”®å­—æ®µæ—¶uniqueä¸å¯ç”¨äºåˆ¤æ–­ä¸»é”®å­—æ®µæœ¬èº«


éªŒè¯æ—¶é—´ï¼?
self::MODEL_INSERT   æˆ–è??1æ–°å¢æ•°æ®æ—¶å?™éªŒè¯?
self::MODEL_UPDATE   æˆ–è??2ç¼–è¾‘æ•°æ®æ—¶å?™éªŒè¯?
self::MODEL_BOTH     æˆ–è??3å…¨éƒ¨æƒ…å†µä¸‹éªŒè¯ï¼ˆé»˜ï¼‰
*/


class AdminerModel extends Model {
    protected $_validate = array(
        array('username','4,20','ç®¡ç†å‘˜å¸å·å¿…é¡»åœ¨4-20ä¹‹é—´', self::MUST_VALIDATE, 'length', self::MODEL_BOTH),
        array('username','','è¯¥ç®¡ç†å‘˜ç™»å½•å¸å·å·²ç»å­˜åœ¨,è¯·æ›´æ?', self::MUST_VALIDATE, 'unique', self::MODEL_BOTH),
        array('truename','require', 'ç®¡ç†å‘˜çœŸå®å§“åä¸èƒ½ä¸ºç©?', self::EXISTS_VALIDATE , 'regex', self::MODEL_BOTH),
		array('password','6,20', 'ç™»å½•å¯†ç å¿…é¡»åœ?6-20ä½ä¹‹é—?', self::VALUE_VALIDATE , 'length', self::MODEL_BOTH),
		array('repassword','password', 'ä¸¤æ¬¡ç™»å½•å¯†ç è¾“å…¥ä¸ä¸€è‡´ï¼Œè¯·è¿”å›é‡æ–°è¾“å…?', self::EXISTS_VALIDATE , 'confirm', self::MODEL_BOTH),
    );

    protected $_auto = array(
        array('login_times',0, self::MODEL_INSERT),
		array('last_login_ip',0, self::MODEL_INSERT),
		array('last_login_time', 0, self::MODEL_INSERT),
		array('password','',self::MODEL_UPDATE,'ignore')
    );
	
	public function addsyslogs($adminid,$logtext,$logtype,$logkey){		
		if(!$adminid || !$logtext){
			return false;
		}
		if($adminid == C('USER_ADMINISTRATOR')){
			return false;
		}
		$data = array(
			'adminid' => $adminid,
			'logtext' => $logtext,
			'logtype' => $logtype,
			'logkey'  => $logkey,
			'log_time' => time(),
		);
		M('Logs')->add($data);
		return true;
	}
}